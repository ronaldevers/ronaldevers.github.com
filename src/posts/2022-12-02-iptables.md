---
title: IPTables gotcha
permalink: /iptables/
---

## Device name with negation

IPTables will happily create a rule for a device called `!eth1`. But if you want
to match traffic that is going out on any interface except `eth1` then you must
put the exclamation mark before the option and not before the name. So `! -o
eth1` instead of `-o !eth1`.

This is documented in the manual but it's an easy mistake to make and it cost me
a bunch of time today!

Wrong:

```sh
iptables -t nat -A POSTROUTING -o !eth1 -j MASQUERADE
```

Right:

```sh
iptables -t nat -A POSTROUTING ! -o eth1 -j MASQUERADE
```
